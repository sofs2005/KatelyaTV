# KatelyaTV v0.6.0-katelya 发布记录

## 🎉 重大更新

### 📺 TVBox 集成优化

- **用户界面改进**

  - 在用户菜单中新增"TVBox 配置"按钮，提供便捷的配置入口
  - 优化配置页面用户体验，支持一键复制配置链接
  - 新增电视图标标识，界面更加直观

- **认证机制优化**
  - **重要变更**：TVBox API (`/api/tvbox`) 现已开放无需认证访问
  - 解决 TVBox 客户端无法登录的根本问题
  - 支持直接在 TVBox 应用中使用配置链接，无需预先登录
  - 确保其他管理 API 仍受认证保护，维护系统安全

### 🔧 技术优化

#### Cloudflare Pages 部署支持

- **Edge Runtime 全面兼容**
  - 修复所有 API 路由的 Edge Runtime 配置问题
  - 解决 Cloudflare Pages 部署失败的核心问题
  - 重构文件系统访问逻辑，使用 `getConfig()` 替代 `fs.readFileSync`
  - 确保生产环境部署稳定性

#### 代码质量提升

- **ESLint 规则优化**
  - 修复导入排序问题，确保代码风格一致性
  - 解决所有编译时警告和错误
  - 提升代码可维护性和团队协作效率

### 🌐 部署兼容性

- ✅ **Cloudflare Pages** - 完全支持，Edge Runtime 兼容
- ✅ **Vercel** - 自动适配，零配置部署
- ✅ **Docker** - 容器化部署，跨平台兼容
- ✅ **传统服务器** - Node.js 运行时，稳定运行

### 📱 TVBox 使用指南

#### 配置方式

1. **通过用户菜单**：

   - 登录 KatelyaTV 网站
   - 点击右上角用户头像
   - 选择"TVBox 配置"
   - 复制配置链接到 TVBox 应用

2. **直接访问**：

   - JSON 格式：`https://your-domain.com/api/tvbox?format=json`

   - Base64 格式：`https://your-domain.com/api/tvbox?format=base64`

#### 支持的客户端

- TVBox 官方版本
- TVBox 开源版本
- 影视仓
- 其他兼容 TVBox 标准的应用

### 🔄 迁移指南

从 v0.5.x 升级到 v0.6.0：

1. **无需数据迁移**：配置数据完全兼容
2. **新功能可选**：现有功能保持不变
3. **推荐操作**：重新部署以获取 Cloudflare Pages 优化

### 🐛 修复的问题

- 修复 Cloudflare Pages 部署时的 Edge Runtime 配置错误
- 解决 TVBox API 认证导致的访问失败问题
- 修复代码导入排序导致的 ESLint 警告
- 优化构建过程，减少 Windows 开发环境的权限警告

### ⚠️ 重要说明

- **安全考虑**：TVBox API 开放访问不会泄露敏感信息，配置数据主要包含公开的视频源地址
- **向后兼容**：现有用户的所有功能和数据保持不变
- **推荐升级**：建议所有用户升级以获得更好的 TVBox 集成体验

---

## 🚀 下一版本预告

- 更多视频源集成
- 播放性能优化
- 移动端体验改进
- 更多第三方客户端支持

---

**发布日期**：2025 年 9 月 3 日  
**版本标签**：v0.6.0-katelya  
**兼容性**：向下兼容 v0.5.x 所有功能
